{
  "filename": "configuration-load-process.md",
  "__html": "<h1>Configuration Loading Process</h1>\n<p>This document focuses on <strong>how the Dubbo framework collects the required configuration</strong> (including application configuration, registry configuration, service configuration, etc.) <strong>during the application startup phase</strong> to complete the process of service exposure and reference.</p>\n<p>Depending on how you drive it (such as Spring or naked API programming), the configuration form will certainly vary, for detail please refer to <a href=\"./xml.md\">XML Configuration</a>, <a href=\"./annotation.md\">Annotation Configuration</a> and <a href=\"./api.md\">API Configuration</a>. In addition to the differences in peripheral drivers, Dubbo's configuration reads generally follow the following principles:</p>\n<ol>\n<li>Dubbo supports multiple levels of configuration and automatically override configurations according to predetermined priorities. Eventually, all configurations are aggregated to the data bus URL to drive subsequent service exposure, reference and other processes.</li>\n<li>ApplicationConfig, ServiceConfig and ReferenceConfig can be regarded as configuration sources, which collect configuration by directly user-oriented programming.</li>\n<li>The configuration format is mainly <code>Properties</code>, and the configuration content follows conventions</li>\n<li>The configuration format is mainly Properties, and the configuration content follows the agreed <code>path-based</code> naming [specification](#Configuration Format).</li>\n</ol>\n<h2>Configuration Source</h2>\n<p>First, starting with the configuration sources that Dubbo supports, there are four default configuration sources:</p>\n<ul>\n<li>JVM System Propertiesï¼Œ-Dproperty</li>\n<li>Externalized Configuration</li>\n<li>ServiceConfig, ReferenceConfig and other programming interface collected configuration</li>\n<li>Local configuration file dubbo.properties</li>\n</ul>\n<h3>Override Priority</h3>\n<p>The figure below shows the priority of configuration override, decreasing from top to bottom:</p>\n<p><img src=\"/img/blog/configuration.jpg\" alt=\"Override Priority\"></p>\n<p>click here to view <a href=\"./config-center.md\">Externalize configuration details</a></p>\n<h2>Configuration Format</h2>\n<p>Currently, all configurations supported by Dubbo are in the format of <code>.properties</code>, including <code>-D</code>, <code>Externalized Configuration</code>, etc., and all configuration items in <code>.properties</code> follow a <code>path-based</code> Configuration format:</p>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\"># Application level</span>\n<span class=\"hljs-meta\">dubbo.{config-type}[.{config-id}].{config-item}</span>=<span class=\"hljs-string\">{config-item-value}</span>\n<span class=\"hljs-comment\"># Service level</span>\n<span class=\"hljs-meta\">dubbo.service.{interface-name}[.{method-name}].{config-item}</span>=<span class=\"hljs-string\">{config-item-value}</span>\n<span class=\"hljs-meta\">dubbo.reference.{interface-name}[.{method-name}].{config-item}</span>=<span class=\"hljs-string\">{config-item-value}</span>\n<span class=\"hljs-comment\"># Multiple configuration items</span>\n<span class=\"hljs-meta\">dubbo.{config-type}s.{config-id}.{config-item}</span>=<span class=\"hljs-string\">{config-item-value}</span>\n</code></pre>\n<ul>\n<li>Application level</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-meta\">dubbo.application.name</span>=<span class=\"hljs-string\">demo-provider</span>\n<span class=\"hljs-meta\">dubbo.registry.address</span>=<span class=\"hljs-string\">zookeeper://127.0.0.1:2181</span>\n<span class=\"hljs-meta\">dubbo.protocol.port</span>=<span class=\"hljs-string\">-1</span>\n</code></pre>\n<ul>\n<li>Service level</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-meta\">dubbo.service.org.apache.dubbo.samples.api.DemoService.timeout</span>=<span class=\"hljs-string\">5000</span>\n<span class=\"hljs-meta\">dubbo.reference.org.apache.dubbo.samples.api.DemoService.timeout</span>=<span class=\"hljs-string\">6000</span>\n<span class=\"hljs-meta\">dubbo.reference.org.apache.dubbo.samples.api.DemoService.sayHello.timeout</span>=<span class=\"hljs-string\">7000</span>\n</code></pre>\n<ul>\n<li>Multiple configuration items</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-meta\">dubbo.registries.unit1.address</span>=<span class=\"hljs-string\">zookeeper://127.0.0.1:2181</span>\n<span class=\"hljs-meta\">dubbo.registries.unit2.address</span>=<span class=\"hljs-string\">zookeeper://127.0.0.1:2182</span>\n\n<span class=\"hljs-meta\">dubbo.protocols.dubbo.name</span>=<span class=\"hljs-string\">dubbo</span>\n<span class=\"hljs-meta\">dubbo.protocols.dubbo.port</span>=<span class=\"hljs-string\">20880</span>\n<span class=\"hljs-meta\">dubbo.protocols.hessian.name</span>=<span class=\"hljs-string\">hessian</span>\n<span class=\"hljs-meta\">dubbo.protocols.hessian.port</span>=<span class=\"hljs-string\">8089</span>\n</code></pre>\n<ul>\n<li>Extended configuration</li>\n</ul>\n<pre><code class=\"language-properties\"><span class=\"hljs-meta\">dubbo.application.parameters.item1</span>=<span class=\"hljs-string\">value1</span>\n<span class=\"hljs-meta\">dubbo.application.parameters.item2</span>=<span class=\"hljs-string\">value2</span>\n<span class=\"hljs-meta\">dubbo.registry.parameters.item3</span>=<span class=\"hljs-string\">value3</span>\n<span class=\"hljs-meta\">dubbo.reference.org.apache.dubbo.samples.api.DemoService.parameters.item4</span>=<span class=\"hljs-string\">value4</span>\n</code></pre>\n<h2>Several programming approaches of configuration</h2>\n<p>Next, let's look at the changes corresponding to <code>ServiceConfig, ReferenceConfig and other programming interface collected configuration</code> when selecting different development methods.</p>\n<h3>Spring</h3>\n<ul>\n<li>XML</li>\n</ul>\n<p>Refer to <a href=\"https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-basic\">the sample</a></p>\n<pre><code class=\"language-xml\">  <span class=\"hljs-comment\">&lt;!-- dubbo-provier.xml --&gt;</span>\n  \n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:application</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"demo-provider\"</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:config-center</span> <span class=\"hljs-attr\">address</span>=<span class=\"hljs-string\">\"zookeeper://127.0.0.1:2181\"</span>/&gt;</span>\n  \n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:registry</span> <span class=\"hljs-attr\">address</span>=<span class=\"hljs-string\">\"zookeeper://127.0.0.1:2181\"</span> <span class=\"hljs-attr\">simplified</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:metadata-report</span> <span class=\"hljs-attr\">address</span>=<span class=\"hljs-string\">\"redis://127.0.0.1:6379\"</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:protocol</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"dubbo\"</span> <span class=\"hljs-attr\">port</span>=<span class=\"hljs-string\">\"20880\"</span>/&gt;</span>\n  \n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">bean</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"demoService\"</span> <span class=\"hljs-attr\">class</span>=<span class=\"hljs-string\">\"org.apache.dubbo.samples.basic.impl.DemoServiceImpl\"</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dubbo:service</span> <span class=\"hljs-attr\">interface</span>=<span class=\"hljs-string\">\"org.apache.dubbo.samples.basic.api.DemoService\"</span> <span class=\"hljs-attr\">ref</span>=<span class=\"hljs-string\">\"demoService\"</span>/&gt;</span>\n</code></pre>\n<ul>\n<li>Annotation</li>\n</ul>\n<p>Refer to <a href=\"https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-annotation\">the sample</a></p>\n<pre><code class=\"language-java\">  <span class=\"hljs-comment\">// AnnotationService implementation</span>\n  \n  <span class=\"hljs-meta\">@Service</span>\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">AnnotationServiceImpl</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">AnnotationService</span> </span>{\n      <span class=\"hljs-meta\">@Override</span>\n      <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">sayHello</span><span class=\"hljs-params\">(String name)</span> </span>{\n          System.out.println(<span class=\"hljs-string\">\"async provider received: \"</span> + name);\n          <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">\"annotation: hello, \"</span> + name;\n      }\n  }\n</code></pre>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\">  ## dubbo.properties</span>\n  \n  <span class=\"hljs-meta\">dubbo.application.name</span>=<span class=\"hljs-string\">annotation-provider</span>\n  <span class=\"hljs-meta\">dubbo.registry.address</span>=<span class=\"hljs-string\">zookeeper://127.0.0.1:2181</span>\n  <span class=\"hljs-meta\">dubbo.protocol.name</span>=<span class=\"hljs-string\">dubbo</span>\n  <span class=\"hljs-meta\">dubbo.protocol.port</span>=<span class=\"hljs-string\">20880</span>\n</code></pre>\n<ul>\n<li>Spring Boot</li>\n</ul>\n<p>Refer to <a href=\"https://github.com/apache/dubbo-spring-boot-project/tree/master/dubbo-spring-boot-samples\">the sample</a></p>\n<pre><code class=\"language-properties\"><span class=\"hljs-comment\">  ## application.properties</span>\n<span class=\"hljs-comment\">  \n  # Spring boot application</span>\n  <span class=\"hljs-meta\">spring.application.name</span>=<span class=\"hljs-string\">dubbo-externalized-configuration-provider-sample</span>\n<span class=\"hljs-comment\">  \n  # Base packages to scan Dubbo Component: @com.alibaba.dubbo.config.annotation.Service</span>\n  <span class=\"hljs-meta\">dubbo.scan.base-packages</span>=<span class=\"hljs-string\">com.alibaba.boot.dubbo.demo.provider.service</span>\n<span class=\"hljs-comment\">  \n  # Dubbo Application</span>\n<span class=\"hljs-comment\">  ## The default value of dubbo.application.name is ${spring.application.name}</span>\n<span class=\"hljs-comment\">  ## dubbo.application.name=${spring.application.name}</span>\n<span class=\"hljs-comment\">  \n  # Dubbo Protocol</span>\n  <span class=\"hljs-meta\">dubbo.protocol.name</span>=<span class=\"hljs-string\">dubbo</span>\n  <span class=\"hljs-meta\">dubbo.protocol.port</span>=<span class=\"hljs-string\">12345</span>\n<span class=\"hljs-comment\">  \n  ## Dubbo Registry</span>\n  <span class=\"hljs-meta\">dubbo.registry.address</span>=<span class=\"hljs-string\">N/A</span>\n<span class=\"hljs-comment\">  \n  ## DemoService version</span>\n  <span class=\"hljs-meta\">demo.service.version</span>=<span class=\"hljs-string\">1.0.0</span>\n</code></pre>\n<h3>API</h3>\n<pre><code class=\"language-java\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> IOException </span>{\n    ServiceConfig&lt;GreetingsService&gt; service = <span class=\"hljs-keyword\">new</span> ServiceConfig&lt;&gt;();\n    service.setApplication(<span class=\"hljs-keyword\">new</span> ApplicationConfig(<span class=\"hljs-string\">\"first-dubbo-provider\"</span>));\n    service.setRegistry(<span class=\"hljs-keyword\">new</span> RegistryConfig(<span class=\"hljs-string\">\"multicast://224.5.6.7:1234\"</span>));\n    service.setInterface(GreetingsService<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;\n    service.setRef(<span class=\"hljs-keyword\">new</span> GreetingsServiceImpl());\n    service.export();\n    System.out.println(<span class=\"hljs-string\">\"first-dubbo-provider is running.\"</span>);\n    System.in.read();\n}\n</code></pre>\n<p>Refer to <a href=\"https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-api\">the sample</a></p>\n",
  "link": "/en-us/docs/user/configuration/configuration-load-process.html",
  "meta": {}
}